<!DOCTYPE html>
<html>
<head>
  <title> Main | {{defaults.sysName}}</title>
  <link rel="stylesheet" type="text/css" href="css/reset.css">
  <link rel="stylesheet" type="text/css" href="css/defaults.css">
  <link rel="stylesheet" type="text/css" href="css/navbar.css">
  <link rel="icon" type="image/x-icon" href="/favicon.ico">
  <script src="https://cdn.jsdelivr.net/npm/moment@2.30.1/moment.min.js"></script>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <script>
    function toggleMaterial(materialId, checkbox) {
      console.log("Material toggled: " + materialId.material);

      var isChecked = checkbox.checked ? 1 : 0;
      
      $.post("/toggle-material", { material_id: materialId, applied: isChecked })
        .done(function() {
          console.log("Material toggled: " + materialId);
        })
        .fail(function() {
          console.log("Failed to toggle material: " + materialId);
        });
    }
  </script>

  <script>
    function add_material(materialId) {
     
      console.log("Add material");
    }

  </script>

</head>
<body>
  <div class="navbar">
    <ul> 
      <li><a href="/">{{defaults.sysName}}</a></li>
      {{#isAdmin}} <li><a href="/admin">admin</a></li> {{/isAdmin}} 
      <li><a href="/dashboard">dashboard</a></li>
      <div style="float:right">
        <li><a href="/auth/google">Log In</a></li>
        <li><a href="/logout">Log Out</a></li>
      </div>
    </ul>
  </div>

  <div class="container">
    {{#takeoff}}
      <h1>{{name}}</h1> </br>
      
      {{owner}}</br>
      {{owner_billing_address}}</br>
      {{created_at}}</br>
      </br>
    {{/takeoff}}

    <table>
      <tr>
        <th>Name</th>
        <th>Measurement</th> 
        <th>Option</th> 
      </tr>
      {{#material}}
      <tr>
        <td>{{name}}</td> 
        <td>{{measurement}} {{measurement_unit}}</td>
        <td>
          <label class="switch">
            <input type="checkbox" 
                   onchange="toggleMaterial({{id}}, this)" 
                   {{#applied}}checked{{/applied}}>
            <span class="slider round"></span>
          </label>
        </td>
        <td>
          <span style = "background-color: inherit;" onclick = "add_material({{id}})" class="fa fa-plus" aria-hidden="true"></span> 
        </td>
      </tr>
      {{/material}}
      {{^material}}
      No subjects found
      {{/material}}
    </table>
  </div>

</body>
</html>
